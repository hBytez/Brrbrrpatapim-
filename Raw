if game.Players.LocalPlayer.PlayerGui:FindFirstChild("KAROXNotice") then
    game.Players.LocalPlayer.PlayerGui.KAROXNotice:Destroy()
end

local TweenService = game:GetService("TweenService")
local playerGui = game.Players.LocalPlayer.PlayerGui

-- Glowy background frame behind KAROXNotice
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "KAROXNotice"
screenGui.ResetOnSpawn = false
screenGui.DisplayOrder = 1000 -- Always on top
screenGui.Parent = playerGui

local glowFrame = Instance.new("Frame")
glowFrame.Name = "GlowFrame"
glowFrame.Size = UDim2.new(0, 400, 0, 110)
glowFrame.Position = UDim2.new(1, -410, 1, -120)
glowFrame.BackgroundColor3 = Color3.fromRGB(50, 150, 250)
glowFrame.BackgroundTransparency = 0.8
glowFrame.AnchorPoint = Vector2.new(0, 0)
glowFrame.ZIndex = 9
glowFrame.Parent = screenGui

local glowUICorner = Instance.new("UICorner")
glowUICorner.CornerRadius = UDim.new(0, 18)
glowUICorner.Parent = glowFrame

local pulseTweenInfo = TweenInfo.new(2, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true)
local pulseTween = TweenService:Create(glowFrame, pulseTweenInfo, {BackgroundTransparency = 0.6})
pulseTween:Play()

local frame = Instance.new("Frame")
frame.Name = "NotificationFrame"
frame.Size = UDim2.new(0, 380, 0, 90)
frame.Position = UDim2.new(1, -400, 1, -110)
frame.BackgroundColor3 = Color3.fromRGB(37, 37, 37)
frame.BorderSizePixel = 0
frame.BackgroundTransparency = 0.05
frame.AnchorPoint = Vector2.new(0, 0)
frame.ZIndex = 10
frame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = frame

local icon = Instance.new("ImageLabel")
icon.Size = UDim2.new(0, 32, 0, 32)
icon.Position = UDim2.new(0, 16, 0, 16)
icon.BackgroundTransparency = 1
icon.Image = "rbxassetid://6031154870" -- Bell icon asset
icon.ZIndex = 11
icon.Parent = frame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -60, 0, 22)
title.Position = UDim2.new(0, 56, 0, 16)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.Text = "KAROX:"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 20
title.TextXAlignment = Enum.TextXAlignment.Left
title.TextYAlignment = Enum.TextYAlignment.Top
title.ZIndex = 11
title.Parent = frame

local desc = Instance.new("TextLabel")
desc.Size = UDim2.new(1, -32, 1, -48)
desc.Position = UDim2.new(0, 16, 0, 38)
desc.BackgroundTransparency = 1
desc.Font = Enum.Font.Gotham
desc.Text = "[KAROX COMBINED ANTI-CHEAT REMOVER IS ACTIVATED. PLEASE WAIT]"
desc.TextColor3 = Color3.fromRGB(230, 230, 230)
desc.TextSize = 16
desc.TextWrapped = true
desc.TextXAlignment = Enum.TextXAlignment.Left
desc.TextYAlignment = Enum.TextYAlignment.Top
desc.ZIndex = 11
desc.Parent = frame

local padding = Instance.new("UIPadding")
padding.PaddingLeft = UDim.new(0, 10)
padding.PaddingTop = UDim.new(0, 6)
padding.PaddingRight = UDim.new(0, 10)
padding.PaddingBottom = UDim.new(0, 6)
padding.Parent = frame

-- Anti-cheat bypass core from original script
local getinfo = getinfo or debug.getinfo
local DEBUG = false
local Hooked = {}

local Detected, Kill
setthreadidentity(2)

for i, v in getgc(true) do
    if typeof(v) == "table" then
        local DetectFunc = rawget(v, "Detected")
        local KillFunc = rawget(v, "Kill")
        if typeof(DetectFunc) == "function" and not Detected then
            Detected = DetectFunc
            local Old; Old = hookfunction(Detected, function(Action, Info, NoCrash)
                if Action ~= "_" then
                    if DEBUG then
                        warn(`Adonis AntiCheat flagged\nMethod: {Action}\nInfo: {Info}`)
                    end
                end
                return true
            end)
            table.insert(Hooked, Detected)
        end
        if rawget(v, "Variables") and rawget(v, "Process") and typeof(KillFunc) == "function" and not Kill then
            Kill = KillFunc
            local Old; Old = hookfunction(Kill, function(Info)
                if DEBUG then
                    warn(`Adonis AntiCheat tried to kill (fallback): {Info}`)
                end
            end)
            table.insert(Hooked, Kill)
        end
    end
end

local Old; Old = hookfunction(getrenv().debug.info, newcclosure(function(...)
    local LevelOrFunc, Info = ...
    if Detected and LevelOrFunc == Detected then
        if DEBUG then warn(`zins | adonis bypassed`) end
        return coroutine.yield(coroutine.running())
    end
    return Old(...)
end))
setthreadidentity(7)

-- Load Anti-Kick
pcall(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/Exunys/Anti-Kick/main/Anti-Kick.lua"))()
end)

-- Additional notification that asks if user wants to see potential anti-cheat
local askGui = Instance.new("ScreenGui")
askGui.Name = "KAROXAsk"
askGui.ResetOnSpawn = false
askGui.DisplayOrder = 1001 -- above KAROXNotice
askGui.Parent = playerGui

local askFrame = Instance.new("Frame")
askFrame.Name = "AskFrame"
askFrame.Size = UDim2.new(0, 380, 0, 70)
askFrame.Position = UDim2.new(1, -400, 1, -190)
askFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
askFrame.BorderSizePixel = 0
askFrame.BackgroundTransparency = 0.1
askFrame.AnchorPoint = Vector2.new(0, 0)
askFrame.ZIndex = 20
askFrame.Parent = askGui

local askCorner = Instance.new("UICorner")
askCorner.CornerRadius = UDim.new(0, 12)
askCorner.Parent = askFrame

local askText = Instance.new("TextLabel")
askText.Size = UDim2.new(1, -20, 0, 40)
askText.Position = UDim2.new(0, 10, 0, 10)
askText.BackgroundTransparency = 1
askText.Font = Enum.Font.GothamBold
askText.Text = "Would you like to see potential anti-cheat?"
askText.TextColor3 = Color3.fromRGB(255, 255, 255)
askText.TextSize = 18
askText.TextWrapped = true
askText.TextXAlignment = Enum.TextXAlignment.Center
askText.ZIndex = 21
askText.Parent = askFrame

local yesButton = Instance.new("TextButton")
yesButton.Name = "YesButton"
yesButton.Text = "Yes"
yesButton.BackgroundColor3 = Color3.fromRGB(50, 150, 250)
yesButton.TextColor3 = Color3.fromRGB(255, 255, 255)
yesButton.Font = Enum.Font.GothamBold
yesButton.TextSize = 16
yesButton.Size = UDim2.new(0, 100, 0, 30)
yesButton.Position = UDim2.new(0.3, 0, 1, -40)
yesButton.AnchorPoint = Vector2.new(0, 1)
yesButton.ZIndex = 21
yesButton.Parent = askFrame
local yesCorner = Instance.new("UICorner", yesButton)
yesCorner.CornerRadius = UDim.new(0, 8)

local noButton = Instance.new("TextButton")
noButton.Name = "NoButton"
noButton.Text = "No"
noButton.BackgroundColor3 = Color3.fromRGB(120, 120, 120)
noButton.TextColor3 = Color3.fromRGB(255, 255, 255)
noButton.Font = Enum.Font.GothamBold
noButton.TextSize = 16
noButton.Size = UDim2.new(0, 100, 0, 30)
noButton.Position = UDim2.new(0.6, 0, 1, -40)
noButton.AnchorPoint = Vector2.new(0, 1)
noButton.ZIndex = 21
noButton.Parent = askFrame
local noCorner = Instance.new("UICorner", noButton)
noCorner.CornerRadius = UDim.new(0, 8)

local function tweenPosition(guiObject, targetPos, duration, onComplete)
    local tween = TweenService:Create(guiObject, TweenInfo.new(duration, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Position = targetPos})
    tween:Play()
    if onComplete then
        tween.Completed:Connect(onComplete)
    end
end

local function fadeOutGui(guiObj, fadeTime, onComplete)
    local tweenBackground = TweenService:Create(guiObj.Frame or guiObj, TweenInfo.new(fadeTime), {BackgroundTransparency = 1})
    tweenBackground:Play()
    for _, child in ipairs(guiObj:GetChildren()) do
        if child:IsA("TextLabel") or child:IsA("ImageLabel") or child:IsA("TextButton") then
            if child:IsA("TextButton") then
                TweenService:Create(child, TweenInfo.new(fadeTime), {BackgroundTransparency = 1, TextTransparency = 1}):Play()
            else
                TweenService:Create(child, TweenInfo.new(fadeTime), {TextTransparency = 1, ImageTransparency = 1}):Play()
            end
        end
    end
    task.delay(fadeTime + 0.1, function()
        guiObj:Destroy()
        if onComplete then
            onComplete()
        end
    end)
end

local function fadeOutKAROXNoticeAndSlideAsk()
    local fadeTime = 2
    TweenService:Create(frame, TweenInfo.new(fadeTime), {BackgroundTransparency = 1}):Play()
    TweenService:Create(icon, TweenInfo.new(fadeTime), {ImageTransparency = 1}):Play()
    TweenService:Create(title, TweenInfo.new(fadeTime), {TextTransparency = 1}):Play()
    TweenService:Create(desc, TweenInfo.new(fadeTime), {TextTransparency = 1}):Play()
    TweenService:Create(glowFrame, TweenInfo.new(fadeTime), {BackgroundTransparency = 1}):Play()

    task.delay(fadeTime + 0.1, function()
        screenGui:Destroy()
        tweenPosition(askFrame, UDim2.new(1, -400, 1, -110), 0.5)
    end)
end

task.delay(6, fadeOutKAROXNoticeAndSlideAsk)

yesButton.Activated:Connect(function()

]]
local Players          = game:GetService("Players")
local RunService       = game:GetService("RunService")
local TweenService     = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer      = Players.LocalPlayer

local toggleKey        = Enum.KeyCode.K
local MAIN_SIZE        = UDim2.new(0,600,0,400)
local MIN_SIZE         = UDim2.new(0,600,0,40)

local UI_OPEN          = false
local UI_MINIMIZED     = false
local scanningInProgress = false
local scanningCanceled   = false
local findingsCount      = 0

local suspiciousObjects = {}

local suspiciousKeywords = {
    -- Injection & Code Execution
    "require","loadstring","load","getfenv","setfenv","spawn","delay","pcall","xpcall",
    -- Function Hooking & Bypassing
    "hookfunction","hookmetamethod","getrawmetatable","setrawmetatable","getnamecallmethod",
    "setnamecallmethod","checkcaller","getconnections","getconnection","getconnectionfunc",
    "newcclosure","islclosure","setfflag","setidentity","clonefunction",
    -- Debugging & Introspection
    "debug.getinfo","debug.getupvalue","debug.setupvalue","debug.getregistry","getgc",
    "getconstants","getconstant","getgenv","getrenv","getsenv","getmetatable","setmetatable",
    "debug.traceback","getproto","getprotos",
    -- Event & Input Simulation
    "fireclickdetector","firetouchinterest","firesignal","MouseButton1Click","MouseButton1Down",
    "MouseButton1Up","MouseButton2Click","keypress","keyrelease","keytap","mousemoverel","mousescroll",
    -- Externes I/O (Datei & Netzwerk)
    "writefile","appendfile","delfile","readfile","loadfile","isfile","isfolder","makefolder",
    "setclipboard","getclipboard","HttpGet","HttpPost","syn.request","http_request","request",
    "queue_on_teleport","rconsoleprint","rconsoleinfo",
    -- Anticheat & Detection
    "kick","ban","antiCheat","ExploitDetected","WalkSpeed","JumpPower","HumanoidRootPart",
    "Health","RemoteEvent","RemoteFunction","BindableEvent","BindableFunction",
    -- Obfuscation & Code Hiding
    "string.char","string.byte","string.reverse","string.gsub","bit32.bxor","base64","decode","encode",
    -- Exploit-Tools & Executor-Indikatoren
    "syn","KRNL_LOADED","isexecutorclosure","SENTINEL_LOADED","secure_load","PROTOSMASHER_LOADED",
    "pebc_execute","is_sirhurt_closure","WrapGlobal","isvm","shadow_env","CalamariLuaEnv",
    -- Allgemeine Exploit-/Hacking-Begriffe
    "cheat","hack","exploit","injection","bypass","noclip","infjump","speedhack","setreadonly",
    "getrawmetatable","hookmetamethod","debug","anticheat","detector","obfuscate","obfuscated",
    "malware","virus","stealer","inject","override","hook","godmode","log","monitor","suspicious",
    "leak","injector","reverse","reverseengineering","backdoor","trojan","keylogger","spy","spyware",
    "rootkit","dump","dumping","spoof","spoofing","packet","intercept","sniff","sniffer","ddos",
    "denial","crash","vulnerability","exploitative","unauthorized","illegal","pirate","cheater",
    "aimbot","wallhack","triggerbot","hacktool","hackclient","modmenu","modded","cheats","autoclicker",
    "bot","scripter","scripting","reinject","substitute","moddedclient","glitch","bug","exploiter",
    "malicious","hacked","systemoverride","dataleak","credential","phish","spoofed","forged","tamper",
    "tampering","bypasssecurity","securityhole","unauthaccess","privilege","elevate","elevation",
    "insecure","vuln"
}


local function safeDecompile(obj)
    if typeof(decompile) == "function" then
        local ok,res = pcall(decompile,obj)
        if ok then
            return res
        else
            return "Error:\n" .. tostring(res)
        end
    end
    return "No decompile() available in this environment."
end

local function getSuspicionLevel(code)
    if not code then
        return "Unsuspicious",0
    end
    local lower = code:lower()
    local hits = 0
    for _,kw in ipairs(suspiciousKeywords) do
        if lower:find(kw) then
            hits = hits + 1
        end
    end
    if hits==0 then
        return "Unsuspicious",0
    elseif hits==1 then
        return "Might be Anticheat",1
    else
        return "Could be Anticheat",hits
    end
end

local function checkRequireCalls(code)
    local found={}
    for match in code:gmatch("[Rr]equire%s*%((.-)%)") do
        table.insert(found,match)
    end
    if #found>0 then
        return "\n\nRequire calls found:\n".. table.concat(found,"\n")
    end
    return ""
end

local function tryGetUpvalues(f)
    local ret={}
    if debug and debug.getupvalues then
        local ok, vals = pcall(debug.getupvalues, f)
        if ok and vals then
            for i,v in pairs(vals) do
                table.insert(ret, "Upvalue #"..i.." = ".. tostring(v))
            end
        end
    end
    return ret
end

local function processInBatches(list, callback, batchSize, progressCb)
    batchSize = batchSize or 100
    local counter=0
    for i,v in ipairs(list) do
        if scanningCanceled then
            return
        end
        callback(v,i,#list)
        counter=counter+1
        if counter>=batchSize then
            counter=0
            RunService.Heartbeat:Wait()
        end
        if progressCb then
            progressCb(i,#list)
        end
    end
end

local function remoteExtraInfo(o)
    local s = "Path: "..o:GetFullName().."\nType: "..o.ClassName
    s = s.."\n\nRemotes can be triggered by scripts or clients.\nCheck .OnServerEvent or .OnServerInvoke.\nBlock usage if suspicious."
    return s
end

local function exploitInfo()
    return "Cheaters can override metamethods or debug functions.\nAdd server checks or randomization to deter hooking."
end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "FinalACFinder"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

local Container = Instance.new("Frame")
Container.Name = "Container"
Container.Parent = ScreenGui
Container.Size = UDim2.new(1, 0, 1, 0)
Container.BackgroundTransparency = 1
Container.ClipsDescendants = false

local function showCustomNotification(title,message,duration)
    duration = duration or 3
    local noti = Instance.new("Frame")
    noti.BackgroundColor3 = Color3.fromRGB(30,30,30)
    noti.BorderSizePixel = 0
    noti.Size = UDim2.new(0,0,0,50)
    noti.ClipsDescendants = true
    noti.Parent = ScreenGui

    local c = Instance.new("UICorner",noti)
    c.CornerRadius = UDim.new(0,8)
    local s = Instance.new("UIStroke",noti)
    s.Thickness = 1
    s.Color = Color3.fromRGB(80,80,80)

    local tLab = Instance.new("TextLabel")
    tLab.Parent = noti
    tLab.BackgroundTransparency = 1
    tLab.Size = UDim2.new(1,-10,0,20)
    tLab.Position = UDim2.new(0,5,0,5)
    tLab.Font = Enum.Font.SourceSansBold
    tLab.TextSize = 14
    tLab.TextColor3 = Color3.fromRGB(255,255,255)
    tLab.TextXAlignment = Enum.TextXAlignment.Left
    tLab.Text = title

    local mLab = Instance.new("TextLabel")
    mLab.Parent = noti
    mLab.BackgroundTransparency = 1
    mLab.Size = UDim2.new(1,-10,0,20)
    mLab.Position = UDim2.new(0,5,0,25)
    mLab.Font = Enum.Font.SourceSans
    mLab.TextSize = 14
    mLab.TextColor3 = Color3.fromRGB(220,220,220)
    mLab.TextXAlignment = Enum.TextXAlignment.Left
    mLab.Text = message

    noti:TweenSize(UDim2.new(0,300,0,50),Enum.EasingDirection.Out,Enum.EasingStyle.Quad,0.15,true)

    task.delay(duration,function()
        noti:TweenSize(UDim2.new(0,0,0,50),Enum.EasingDirection.In,Enum.EasingStyle.Quad,0.15,true,function()
            noti:Destroy()
        end)
    end)
end


local function makeFrameDraggable(frame)
    local dragging = false
    local dragInput, mousePos, framePos

    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            -- Falls Minimiert, Drag unterbinden (optional)
            if UI_MINIMIZED then return end

            dragging = true
            mousePos = input.Position
            framePos = frame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and input == dragInput then
            local delta = input.Position - mousePos
            frame.Position = UDim2.new(
                framePos.X.Scale,
                framePos.X.Offset + delta.X,
                framePos.Y.Scale,
                framePos.Y.Offset + delta.Y
            )
        end
    end)
end

local MAIN_FRAME = Instance.new("Frame")
MAIN_FRAME.Name = "MainFrame"
MAIN_FRAME.Parent = Container
MAIN_FRAME.BackgroundColor3 = Color3.fromRGB(20,20,20)
MAIN_FRAME.BorderSizePixel = 0
MAIN_FRAME.Size = UDim2.new(0,0,0,0) 
MAIN_FRAME.ClipsDescendants = false
MAIN_FRAME.Visible = false       

local mainCorner = Instance.new("UICorner",MAIN_FRAME)
mainCorner.CornerRadius = UDim.new(0,15)

local mainStroke = Instance.new("UIStroke",MAIN_FRAME)
mainStroke.Color = Color3.fromRGB(76,76,76)
mainStroke.Thickness = 1

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Name = "Title"
TitleLabel.Parent = MAIN_FRAME
TitleLabel.BackgroundTransparency = 1
TitleLabel.Position = UDim2.new(0.02,0,0.03,0)
TitleLabel.Size = UDim2.new(0,300,0,20)
TitleLabel.Font = Enum.Font.SourceSansBold
TitleLabel.Text = "Anticheat Finder | by cyberseall"
TitleLabel.TextColor3 = Color3.fromRGB(255,255,255)
TitleLabel.TextSize = 16
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left

local Shadow = Instance.new("Frame")
Shadow.Name = "Shadow"
Shadow.Parent = MAIN_FRAME
Shadow.AnchorPoint = Vector2.new(0.5,0.5)
Shadow.Position = UDim2.new(0.5,0,0.5,0)
Shadow.Size = UDim2.new(1,35,1,35)
Shadow.BackgroundTransparency = 1

local ShadowImage = Instance.new("ImageLabel")
ShadowImage.Name = "ShadowImage"
ShadowImage.Parent = Shadow
ShadowImage.AnchorPoint = Vector2.new(0.5,0.5)
ShadowImage.Position = UDim2.new(0.5,0,0.5,0)
ShadowImage.Size = UDim2.new(1.74,0,1.4,0)
ShadowImage.Image = "rbxassetid://5587865193"
ShadowImage.ImageColor3 = Color3.fromRGB(20,20,20)
ShadowImage.ImageTransparency = 0.48
ShadowImage.BackgroundTransparency = 1

-- Schlie√üen:
local function hideMainGUI()
    if not UI_OPEN then return end
    UI_OPEN = false

    local tween = TweenService:Create(MAIN_FRAME,
        TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.In),
        { Size = UDim2.new(0,0,0,0) }
    )
    tween:Play()
    tween.Completed:Connect(function()
        MAIN_FRAME.Visible = false
    end)

    showCustomNotification("UI closed","Press K to reopen",3)
end

local CloseBtn = Instance.new("TextButton")
CloseBtn.Name = "CloseBtn"
CloseBtn.Parent = MAIN_FRAME
CloseBtn.AnchorPoint = Vector2.new(1,0)
CloseBtn.Position = UDim2.new(1,-5,0,5)
CloseBtn.Size = UDim2.new(0,25,0,25)
CloseBtn.Text = "X"
CloseBtn.Font = Enum.Font.SourceSansBold
CloseBtn.TextSize = 14
CloseBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)
CloseBtn.TextColor3 = Color3.fromRGB(255,255,255)
local cco = Instance.new("UICorner",CloseBtn)
cco.CornerRadius = UDim.new(0,5)
CloseBtn.MouseButton1Click:Connect(function()
    hideMainGUI()
end)

local MinBtn = Instance.new("TextButton")
MinBtn.Name = "MinimizeBtn"
MinBtn.Parent = MAIN_FRAME
MinBtn.AnchorPoint = Vector2.new(1,0)
MinBtn.Position = UDim2.new(1,-35,0,5)
MinBtn.Size = UDim2.new(0,25,0,25)
MinBtn.Text = "_"
MinBtn.Font = Enum.Font.SourceSansBold
MinBtn.TextSize = 20
MinBtn.BackgroundColor3 = Color3.fromRGB(27,27,27)
MinBtn.TextColor3 = Color3.fromRGB(255,255,255)
local minCorner = Instance.new("UICorner",MinBtn)
minCorner.CornerRadius = UDim.new(0,5)

MinBtn.MouseButton1Click:Connect(function()
    if UI_MINIMIZED then
        TweenService:Create(MAIN_FRAME,
            TweenInfo.new(0.2,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),
            {Size = MAIN_SIZE}
        ):Play()
        UI_MINIMIZED = false
    else
        TweenService:Create(MAIN_FRAME,
            TweenInfo.new(0.2,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),
            {Size = MIN_SIZE}
        ):Play()
        UI_MINIMIZED = true
    end
end)

makeFrameDraggable(MAIN_FRAME)


local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MAIN_FRAME
ContentFrame.BackgroundTransparency = 1
ContentFrame.Position = UDim2.new(0,0,0,40)
ContentFrame.Size = UDim2.new(1,0,1,-40)

local Listener = Instance.new("ScrollingFrame")
Listener.Name = "Listener"
Listener.Parent = ContentFrame
Listener.BackgroundTransparency = 1
Listener.Position = UDim2.new(0,10,0,10)
Listener.Size = UDim2.new(1,-20,0,250)
Listener.CanvasSize = UDim2.new(0,0,10,0)
Listener.ScrollBarThickness = 6

local layout = Instance.new("UIListLayout")
layout.Parent = Listener
layout.SortOrder = Enum.SortOrder.LayoutOrder
layout.Padding = UDim.new(0,5)

local ResultTemplate = Instance.new("Frame")
ResultTemplate.Name = "ResultTemplate"
ResultTemplate.BackgroundTransparency = 1
ResultTemplate.Size = UDim2.new(1,0,0,25)

local PathLabel = Instance.new("TextLabel")
PathLabel.Name = "Path"
PathLabel.Parent = ResultTemplate
PathLabel.BackgroundTransparency = 1
PathLabel.Position = UDim2.new(0,5,0,0)
PathLabel.Size = UDim2.new(1,-140,1,0)
PathLabel.Font = Enum.Font.SourceSans
PathLabel.TextColor3 = Color3.fromRGB(161,161,161)
PathLabel.TextSize = 14
PathLabel.TextXAlignment = Enum.TextXAlignment.Left
PathLabel.TextTruncate = Enum.TextTruncate.AtEnd
PathLabel.RichText = true

local ViewBtn = Instance.new("TextButton")
ViewBtn.Name = "View"
ViewBtn.Parent = ResultTemplate
ViewBtn.BackgroundColor3 = Color3.fromRGB(27,27,27)
ViewBtn.Size = UDim2.new(0,60,0,25)
ViewBtn.AnchorPoint = Vector2.new(1,0)
ViewBtn.Position = UDim2.new(1,-70,0,0)
ViewBtn.Font = Enum.Font.SourceSans
ViewBtn.TextColor3 = Color3.fromRGB(255,255,255)
ViewBtn.TextSize = 14
ViewBtn.Text = "View"
local vbCorner = Instance.new("UICorner",ViewBtn)
vbCorner.CornerRadius = UDim.new(0,5)
local vbStroke = Instance.new("UIStroke",ViewBtn)
vbStroke.Thickness = 1
vbStroke.Color = Color3.fromRGB(36,36,36)

local CopyBtn = Instance.new("TextButton")
CopyBtn.Name = "Copy"
CopyBtn.Parent = ResultTemplate
CopyBtn.BackgroundColor3 = Color3.fromRGB(27,27,27)
CopyBtn.Size = UDim2.new(0,60,0,25)
CopyBtn.AnchorPoint = Vector2.new(1,0)
CopyBtn.Position = UDim2.new(1,-5,0,0)
CopyBtn.Font = Enum.Font.SourceSans
CopyBtn.TextColor3 = Color3.fromRGB(255,255,255)
CopyBtn.TextSize = 14
CopyBtn.Text = "Copy"
local cbCorner = Instance.new("UICorner",CopyBtn)
cbCorner.CornerRadius = UDim.new(0,5)
local cbStroke = Instance.new("UIStroke",CopyBtn)
cbStroke.Thickness = 1
cbStroke.Color = Color3.fromRGB(36,36,36)


local ActionZone = Instance.new("Frame")
ActionZone.Name = "ActionZone"
ActionZone.Parent = ContentFrame
ActionZone.BackgroundTransparency = 1
ActionZone.Position = UDim2.new(0,0,1,-40)
ActionZone.Size = UDim2.new(1,0,0,40)

local Uninject = Instance.new("TextButton")
Uninject.Name = "Uninject"
Uninject.Parent = ActionZone
Uninject.BackgroundColor3 = Color3.fromRGB(27,27,27)
Uninject.Size = UDim2.new(0,120,0,30)
Uninject.Position = UDim2.new(0,10,0,5)
Uninject.Font = Enum.Font.SourceSansBold
Uninject.TextColor3 = Color3.fromRGB(255,255,255)
Uninject.TextSize = 16
Uninject.Text = "Uninject"
local unCorner = Instance.new("UICorner",Uninject)
unCorner.CornerRadius = UDim.new(0,5)
local unStroke = Instance.new("UIStroke",Uninject)
unStroke.Thickness = 1
unStroke.Color = Color3.fromRGB(36,36,36)

local StartBtn = Instance.new("TextButton")
StartBtn.Name = "StartAnalysis"
StartBtn.Parent = ActionZone
StartBtn.BackgroundColor3 = Color3.fromRGB(27,27,27)
StartBtn.Size = UDim2.new(0,120,0,30)
StartBtn.Position = UDim2.new(0,140,0,5)
StartBtn.Font = Enum.Font.SourceSansBold
StartBtn.TextColor3 = Color3.fromRGB(255,255,255)
StartBtn.TextSize = 16
StartBtn.Text = "Start Analysis"
local sCorner = Instance.new("UICorner",StartBtn)
sCorner.CornerRadius = UDim.new(0,5)
local sStroke = Instance.new("UIStroke",StartBtn)
sStroke.Thickness = 1
sStroke.Color = Color3.fromRGB(36,36,36)

local MultiBtn = Instance.new("TextButton")
MultiBtn.Name = "MultiScan"
MultiBtn.Parent = ActionZone
MultiBtn.BackgroundColor3 = Color3.fromRGB(27,27,27)
MultiBtn.Size = UDim2.new(0,120,0,30)
MultiBtn.Position = UDim2.new(0,270,0,5)
MultiBtn.Font = Enum.Font.SourceSansBold
MultiBtn.TextColor3 = Color3.fromRGB(255,255,255)
MultiBtn.TextSize = 16
MultiBtn.Text = "Multi-Scan"
local mCorner = Instance.new("UICorner",MultiBtn)
mCorner.CornerRadius = UDim.new(0,5)
local mStroke = Instance.new("UIStroke",MultiBtn)
mStroke.Thickness = 1
mStroke.Color = Color3.fromRGB(36,36,36)

local StopSuspiciousBtn = Instance.new("TextButton")
StopSuspiciousBtn.Name = "StopSuspicious"
StopSuspiciousBtn.Parent = ActionZone
StopSuspiciousBtn.BackgroundColor3 = Color3.fromRGB(27,27,27)
StopSuspiciousBtn.Size = UDim2.new(0,180,0,30)
StopSuspiciousBtn.Position = UDim2.new(0,400,0,5)
StopSuspiciousBtn.Font = Enum.Font.SourceSansBold
StopSuspiciousBtn.TextColor3 = Color3.fromRGB(255,255,255)
StopSuspiciousBtn.TextSize = 16
StopSuspiciousBtn.Text = "Stop Suspicious"
local ssCorner = Instance.new("UICorner", StopSuspiciousBtn)
ssCorner.CornerRadius = UDim.new(0, 5)
local ssStroke = Instance.new("UIStroke", StopSuspiciousBtn)
ssStroke.Thickness = 1
ssStroke.Color = Color3.fromRGB(36,36,36)

StopSuspiciousBtn.MouseButton1Click:Connect(function()
    for _, obj in ipairs(suspiciousObjects) do
        if obj and obj.Parent then
            showCustomNotification("Stopped", "Stopped: " .. obj:GetFullName(), 2)
            obj:Destroy()
        end
    end
    suspiciousObjects = {}
end)


local function openScriptViewer(txt)
    local viewer = Instance.new("Frame")
    viewer.Name = "ScriptViewer"
    viewer.Parent = ScreenGui
    viewer.BackgroundColor3 = Color3.fromRGB(15,15,15)
    viewer.BorderSizePixel = 0
    viewer.Position = UDim2.new(0.3,0,0.3,0)
    viewer.Size = UDim2.new(0,600,0,400)

    local vCorner = Instance.new("UICorner",viewer)
    vCorner.CornerRadius = UDim.new(0,10)
    local vStroke = Instance.new("UIStroke",viewer)
    vStroke.Thickness = 1
    vStroke.Color = Color3.fromRGB(75,75,75)

    local Topbar = Instance.new("Frame")
    Topbar.Name = "Topbar"
    Topbar.Parent = viewer
    Topbar.BackgroundColor3 = Color3.fromRGB(20,20,20)
    Topbar.BorderSizePixel = 0
    Topbar.Size = UDim2.new(1,0,0,30)

    local tbCorner = Instance.new("UICorner",Topbar)
    tbCorner.CornerRadius = UDim.new(0,10)

    local Title = Instance.new("TextLabel")
    Title.Name = "Title"
    Title.Parent = Topbar
    Title.BackgroundTransparency = 1
    Title.Size = UDim2.new(0.7,0,1,0)
    Title.Position = UDim2.new(0.02,0,0,0)
    Title.Font = Enum.Font.SourceSansBold
    Title.TextSize = 16
    Title.TextColor3 = Color3.fromRGB(255,255,255)
    Title.Text = "Script Viewer"
    Title.TextXAlignment = Enum.TextXAlignment.Left

    local MinV = Instance.new("TextButton")
    MinV.Name = "MinBtn"
    MinV.Parent = Topbar
    MinV.AnchorPoint = Vector2.new(1,0)
    MinV.Position = UDim2.new(1,-60,0,0)
    MinV.Size = UDim2.new(0,30,0,30)
    MinV.Text = "_"
    MinV.Font = Enum.Font.SourceSansBold
    MinV.TextSize = 20
    MinV.BackgroundColor3 = Color3.fromRGB(27,27,27)
    MinV.TextColor3 = Color3.fromRGB(255,255,255)
    local miniCC = Instance.new("UICorner",MinV)
    miniCC.CornerRadius = UDim.new(0,5)

    local Close2 = Instance.new("TextButton")
    Close2.Name = "Close2"
    Close2.Parent = Topbar
    Close2.AnchorPoint = Vector2.new(1,0)
    Close2.Position = UDim2.new(1,-30,0,0)
    Close2.Size = UDim2.new(0,30,0,30)
    Close2.Text = "X"
    C
end)

noButton.Activated:Connect(function()
    fadeOutGui(askGui, 2)
end)
